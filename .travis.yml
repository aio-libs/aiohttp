sudo: required
language: python
services:
  - docker

matrix:
    include:
        - python: 3.4 # these are just to make travis's UI a bit prettier
          env: TOXENV=py34
        - python: 3.4
          env: TOXENV=docs
          addons:
           apt:
            packages:
            - libenchant-dev
        - python: 3.5
          env: TOXENV=py35
        # - language: generic
        #   os: osx
        #   osx_image: xcode8
        #   env: TOXENV=docs
        - language: generic
          os: osx
          osx_image: xcode6.4
          env: TOXENV=py34
        - language: generic
          os: osx
          osx_image: xcode6.4
          env: TOXENV=py35
        - language: generic
          os: osx
          osx_image: xcode7.3
          env: TOXENV=py34
        - language: generic
          os: osx
          osx_image: xcode7.3
          env: TOXENV=py35
        - language: generic
          os: osx
          osx_image: xcode8
          env: TOXENV=py34
        - language: generic
          os: osx
          osx_image: xcode8
          env: TOXENV=py35

cache:
  directories:
  - $HOME/.cache/pip

before_cache:
  - rm -f $HOME/.cache/pip/log/debug.log

install:
  - ./.travis/install.sh

script:
  - ./.travis/run.sh

after_success:
  - codecov
  - ./run_docker.sh

deploy:
  provider: pypi
  user: andrew.svetlov
  password:
    secure: ZQKbdPT9BlNqP5CTbWRQyeyig7Bpf7wsnYVQIQPOZc9Ec74A+dsbagstR1sPkAO+d+5PN0pZMovvmU7OQhSVPAnJ74nsN90/fL4ux3kqYecMbevv0rJg20hMXSSkwMEIpjUsMdMjJvZAcaKytGWmKL0qAlOJHhixd1pBbWyuIUE=
  distributions: "sdist"
  on:
    tags: true
    all_branches: true
    python: 3.5
