Improve test suite handling of paths and temp files to consistently use pathlib and pytest fixtures.
